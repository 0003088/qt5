From c1dd2df8a12c19f1cdca0fabc434ef548ced2a74 Mon Sep 17 00:00:00 2001
From: axis <qt-info@nokia.com>
Date: Thu, 17 Mar 2011 11:17:20 +0100
Subject: [PATCH] Switched to using QT.webkit.imports variable.

This is required for modularized Qt.
---
 Source/WebKit/qt/QtWebKit.pro                |    2 +-
 Source/WebKit/qt/declarative/declarative.pro |    4 ++--
 Source/WebKit/qt/qt_webkit_version.pri       |    1 +
 3 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/Source/WebKit/qt/QtWebKit.pro b/Source/WebKit/qt/QtWebKit.pro
index e572641..7b36e51 100644
--- a/Source/WebKit/qt/QtWebKit.pro
+++ b/Source/WebKit/qt/QtWebKit.pro
@@ -119,7 +119,7 @@ symbian {
     webkitbackup.path = /private/10202D56/import/packages/$$replace(TARGET.UID3, 0x,)
 
     contains(QT_CONFIG, declarative) {
-         declarativeImport.sources = $$QT_BUILD_TREE/imports/QtWebKit/qmlwebkitplugin$${QT_LIBINFIX}.dll
+         declarativeImport.sources = $$QT.webkit.imports/QtWebKit/qmlwebkitplugin$${QT_LIBINFIX}.dll
          declarativeImport.sources += declarative/qmldir
          declarativeImport.path = c:$$QT_IMPORTS_BASE_DIR/QtWebKit
          DEPLOYMENT += declarativeImport
diff --git a/Source/WebKit/qt/declarative/declarative.pro b/Source/WebKit/qt/declarative/declarative.pro
index 1f084b7..96dd247 100644
--- a/Source/WebKit/qt/declarative/declarative.pro
+++ b/Source/WebKit/qt/declarative/declarative.pro
@@ -10,7 +10,7 @@ isEmpty(OUTPUT_DIR): OUTPUT_DIR = ../../..
 
 QMLDIRFILE = $${_PRO_FILE_PWD_}/qmldir
 copy2build.input = QMLDIRFILE
-copy2build.output = $$OUTPUT_DIR/imports/$$TARGETPATH/qmldir
+copy2build.output = $$QT.webkit.imports/$$TARGETPATH/qmldir
 !contains(TEMPLATE_PREFIX, vc):copy2build.variable_out = PRE_TARGETDEPS
 copy2build.commands = $$QMAKE_COPY ${QMAKE_FILE_IN} ${QMAKE_FILE_OUT}
 copy2build.name = COPY ${QMAKE_FILE_IN}
@@ -51,7 +51,7 @@ QT += declarative
 SOURCES += qdeclarativewebview.cpp plugin.cpp
 HEADERS += qdeclarativewebview_p.h
 
-DESTDIR = $$OUTPUT_DIR/imports/$$TARGETPATH
+DESTDIR = $$QT.webkit.imports/$$TARGETPATH
 target.path = $$[QT_INSTALL_IMPORTS]/$$TARGETPATH
 
 
diff --git a/Source/WebKit/qt/qt_webkit_version.pri b/Source/WebKit/qt/qt_webkit_version.pri
index 9f6ba20..e3948c8 100644
--- a/Source/WebKit/qt/qt_webkit_version.pri
+++ b/Source/WebKit/qt/qt_webkit_version.pri
@@ -7,6 +7,7 @@ QT.webkit.name = QtWebKit
 QT.webkit.includes = $$QT_MODULE_INCLUDE_BASE $$QT_MODULE_INCLUDE_BASE/QtWebKit
 QT.webkit.sources = $$QT_MODULE_BASE
 QT.webkit.libs = $$QT_MODULE_LIB_BASE
+QT.webkit.imports = $$QT_MODULE_IMPORT_BASE
 QT.webkit.depends = core gui opengl network xmlpatterns script phonon
 
 !contains(QT_CONFIG, modular)|contains(QT_ELIGIBLE_MODULES, webkit) {
-- 
1.7.3.4

